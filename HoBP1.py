c = '10000 11010 10010 10011 10010 00010 01111 00010 10010 11000 10100 01100 00101 00000 01010 11111 11001 10010 11001 11010 01000 11001 01001 10101 11101 01101 00011 01100 11010 11010 01010 00100 11000 01001 11101 01101 00110 11111 11010 01111 11101 00110 10110 01100 01101 11000 01101 11010 00000 10101 11011 00100 00001 10100 11111 11001 11110 11101 00011 00000 10111 10011 01001 11101 00001 10011 00001 00110 10010 11110 00101 00111 10000 01100 11011 10001 00001 01100 10000 11001 10110 00010 01101 00010'.replace(' ','')
c1 = '10000 11010 10010 10011 10010 00010 01111 00010 10010 11000 10100 01100 00101 00000 01010 11111 11001 10010 11001 11010 01000 11001 01001 10101 11101'.replace(' ','')
crib = '11111 11001 10000 11000 00001 00101 10000 01010 00100 10110 00011 01010 10000 01110 11000 10100 00001 00100 11011 11101 10000 01110 01101 01101 00100'.replace(' ','')
keystream = '01111000110001001011100110011111111010001011001110101110011010101011101001001011110001011000010001111100010111001001100011001'
cipher1 = '00010 11001 00110 01010 11000 11000 10000 00101 00111 10111 00010 11101 11010 10000 01010 10001 10010 01010 10001 10000 10100 11010 01011 11110 11011 10001 11110 00110 01110 10011 11100 11010 11101 10111 00100 00100 01010 10100 00011 10100 01111 01000 01000 00000 10001 10110 00010 10010 01000 01000 00111 01011 00010 00000 01011 11000 00110 01010 10110 00100 01110 00100 11111 01011 10010 01101 01000 11010 01101 00110 11000 10011 10100 01111 10010 11011 10011 00010 01011 10010 11111 10111 00100 00110 10001 10110 10101 01101 01100 11011 10110 01010 01110 00010 01110 01001 10010 10101 01111 10111 00111 00000 10001 01011 11101 00101 10000 01001 11001 10011 11100'.replace(' ','')
keystreamrev = '10011000110010011101000111110001000011010001111010010010111010101011001110101110011010001011111111001100111010010001100011110'

p = int(c1,2) ^ int(crib,2)
print('{0:b}'.format(p))
print('\n')

#keystream - 01111000110001001011100110011111111010001011001110101110011010101011101001001011110001011000010001111100010111001001100011001 Y (generates 61 bit resister)
#61 bit resister tapped at positions 1, 6, 7, 9, 10, 11, 13, 15, 16, 18, 20, 23, 27, 29, 30, 31, 42, 46, 48, 49, 50, 56, 58, 59, 60, 61 YY (generates weather forecast)
#start at 0 - [0, 5, 6, 8, 9, 10, 12, 14, 15, 17, 19, 22, 26, 28, 29, 30, 41, 45, 47, 48, 49, 55, 57, 58, 59, 60] Y (-1)
#tap coefficients - 1,0,0,0,0,1,1,0,1,1,1,0,1,0,1,1,0,1,0,1,0,0,1,0,0,0,1,0,1,1,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,1,1,1,0,0,0,0,0,1,0,1,1,1,1 Y (see above)
#coefficients - 1000011011101011010100100010111000000000010001011100000101111 Y (see above)
#LFSR - Y (two generators produce same output)
#decoding XOR - Y (weather forecast)
#⇩WEATHER FORECAST ⇧13:00 ⇩SOUTHERN ENGLAND FULL CLOUD COVER RAIN SPREADING FROM WEST
#reversed taps - [61, 60, 55, 54, 52, 51, 50, 48, 46, 45, 43, 41, 38, 34, 32, 31, 30, 19, 15, 13, 12, 11, 5, 3, 2, 1, 0]
#⇩CODEWORD ⇧+⇩EVADE⇧+: ⇩CAMOUFLAGED TUBE N⇧51 58.325 ⇩W⇧00 43.717 ⇩BASE OF METAL POST TINYURL⇧.⇩COM⇧/⇩Y⇧9⇩ZYWLZX

key = []
for i in keystream:
    key.append(int(i))
taps = [1, 6, 7, 9, 10, 11, 13, 15, 16, 18, 20, 23, 27, 29, 30, 31, 42, 46, 48, 49, 50, 56, 58, 59, 60, 61]

for i in range(295):
    bit = 0
    for tap in taps:
        bit = bit^key[-tap]
    key.append(bit)

k = ''
for i in key:
    k += str(i)

print('\n')




key = []
for i in keystream[0:61]:
    key.append(int(i))
taps = [1, 6, 7, 9, 10, 11, 13, 15, 16, 18, 20, 23, 27, 29, 30, 31, 42, 46, 48, 49, 50, 56, 58, 59, 60]

for i in range(555):
    last = key[-(i+1)]
    bit = 0
    for tap in taps:
        bit = bit^key[-(i+tap+1)]
    key.insert(0,bit^last)

k1 = ''
for i in key:
    k1 += str(i)

print('\n')

p = int(cipher1,2)^int(k1[0:555],2)
print('{0:b}'.format(p))
print('\n')

